# Инструкция по использованию API подбрасывания монетки

## Описание проекта

Создан контейнер с API для подбрасывания монетки на Python с использованием FastAPI. API предоставляет простой интерфейс для симуляции подбрасывания монетки с возможностью получения статистики.

## Структура проекта

```
coin-flip-api/
├── main.py              # Основной файл API
├── requirements.txt     # Зависимости Python
├── Dockerfile          # Конфигурация Docker
├── docker-compose.yml  # Docker Compose конфигурация
├── manage-final.ps1    # Скрипт управления (PowerShell)
├── README.md           # Документация
└── ИНСТРУКЦИЯ.md       # Эта инструкция
```

## Быстрый старт

### 1. Сборка и запуск контейнера

```powershell
# Перейти в директорию проекта
cd coin-flip-api

# Собрать Docker образ
docker build -t coin-flip-api .

# Запустить контейнер
docker run -d -p 8000:8000 --name coin-flip-container coin-flip-api
```

### 2. Использование скрипта управления

```powershell
# Показать статус контейнера
.\manage-final.ps1 status

# Запустить контейнер
.\manage-final.ps1 start

# Остановить контейнер
.\manage-final.ps1 stop

# Перезапустить контейнер
.\manage-final.ps1 restart

# Показать логи
.\manage-final.ps1 logs

# Протестировать API
.\manage-final.ps1 test
```

## API Эндпоинты

### 1. Информация об API
```
GET http://localhost:8000/
```
Возвращает информацию об API и доступных эндпоинтах.

### 2. Подбросить монетку один раз
```
GET http://localhost:8000/flip
```
Возвращает результат одного подбрасывания монетки.

**Пример ответа:**
```json
{
    "результат": "орёл",
    "сообщение": "Монетка показала: орёл"
}
```

### 3. Подбросить монетку несколько раз
```
POST http://localhost:8000/flip
Content-Type: application/json

{
    "количество": 10
}
```
Подбрасывает монетку указанное количество раз и возвращает статистику.

**Пример ответа:**
```json
{
    "результаты": ["орёл", "решка", "орёл", "решка", "орёл"],
    "статистика": {
        "всего_подбрасываний": 5,
        "орёл": {
            "количество": 3,
            "процент": 60.0
        },
        "решка": {
            "количество": 2,
            "процент": 40.0
        }
    },
    "сообщение": "Подброшено 5 раз(а). Орёл: 3, Решка: 2"
}
```

### 4. Получить статистику
```
GET http://localhost:8000/stats
```
Возвращает общую информацию о возможностях API.

## Документация Swagger UI

После запуска контейнера, интерактивная документация доступна по адресу:
```
http://localhost:8000/docs
```

## Тестирование API

### С помощью PowerShell
```powershell
# Тест корневого эндпоинта
Invoke-RestMethod -Uri "http://localhost:8000/" -Method GET

# Тест подбрасывания один раз
Invoke-RestMethod -Uri "http://localhost:8000/flip" -Method GET

# Тест подбрасывания несколько раз
$body = '{"количество": 5}'
Invoke-RestMethod -Uri "http://localhost:8000/flip" -Method POST -Body $body -ContentType "application/json"

# Тест статистики
Invoke-RestMethod -Uri "http://localhost:8000/stats" -Method GET
```

### С помощью curl
```bash
# Тест корневого эндпоинта
curl http://localhost:8000/

# Тест подбрасывания один раз
curl http://localhost:8000/flip

# Тест подбрасывания несколько раз
curl -X POST http://localhost:8000/flip -H "Content-Type: application/json" -d '{"количество": 5}'

# Тест статистики
curl http://localhost:8000/stats
```

## Управление контейнером

### Основные команды Docker
```bash
# Показать запущенные контейнеры
docker ps

# Показать все контейнеры
docker ps -a

# Остановить контейнер
docker stop coin-flip-container

# Удалить контейнер
docker rm coin-flip-container

# Показать логи
docker logs coin-flip-container

# Перезапустить контейнер
docker restart coin-flip-container
```

### Использование Docker Compose
```bash
# Запустить с помощью Docker Compose
docker-compose up -d

# Остановить
docker-compose down

# Показать логи
docker-compose logs
```

## Особенности

1. **Язык интерфейса**: Все сообщения и названия полей на русском языке
2. **Ограничения**: Максимальное количество подбрасываний за один запрос - 100
3. **Вероятность**: Равная вероятность для каждой стороны (50/50)
4. **Документация**: Автоматическая генерация Swagger UI документации
5. **Обработка ошибок**: Валидация входных данных с понятными сообщениями об ошибках

## Устранение неполадок

### Контейнер не запускается
1. Проверьте, что Docker Desktop запущен
2. Проверьте логи: `docker logs coin-flip-container`
3. Убедитесь, что порт 8000 не занят другим приложением

### API не отвечает
1. Проверьте статус контейнера: `docker ps`
2. Проверьте, что контейнер запущен и порт проброшен
3. Попробуйте перезапустить контейнер

### Ошибки при сборке
1. Убедитесь, что все файлы проекта на месте
2. Проверьте подключение к интернету для загрузки зависимостей
3. Попробуйте очистить Docker кэш: `docker system prune`

## Заключение

API подбрасывания монетки готов к использованию! Контейнер запущен и доступен по адресу `http://localhost:8000`. Используйте скрипт `manage-final.ps1` для удобного управления контейнером. 